
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rail Connect Demo</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .box { border: 1px solid #ccc; padding: 12px; margin-bottom: 12px; border-radius: 6px; }
    button { margin-left: 6px; }
    ul { padding-left: 18px; }
  </style>
</head>
<body>
  <h2>Rail Connect â€“ Mini UI</h2>

  <div class="box">
    <label>Train ID:
      <input id="trainId" value="NDLS-RE-12001">
    </label>
    <label>Passenger:
      <input id="passenger" placeholder="Enter name">
    </label>
    <button onclick="onBook()">Book</button>
    <button onclick="onCancel()">Cancel</button>
    <button onclick="onUndo()">Undo Last</button>
    <span id="msg" style="margin-left:10px;color:#006400;"></span>
  </div>

  <div class="box">
    <h3>Status</h3>
    <p>Seats: <span id="seats">2</span></p>
    <p>Booked:</p>
    <ul id="booked"></ul>
    <p>Waitlist:</p>
    <ul id="waitlist"></ul>
  </div>

  <script>
    const trains = { "NDLS-RE-12001": { seats: 2, booked: [] } };
    const waitlist = [];
    const undoStack = [];

    function render() {
      const t = trains[document.getElementById('trainId').value] || { seats: 0, booked: [] };
      document.getElementById('seats').textContent = t.seats;
      const bookedEl = document.getElementById('booked');
      const wlEl = document.getElementById('waitlist');
      bookedEl.innerHTML = t.booked.map(p => `<li>${p}</li>`).join('');
      wlEl.innerHTML = waitlist
        .filter(w => w.trainId === document.getElementById('trainId').value)
        .map(w => `<li>${w.passenger}</li>`).join('');
    }

    function book(trainId, passenger) {
      const t = trains[trainId];
      if (!t) return "train not found";
      if (t.booked.length < t.seats) { t.booked.push(passenger); return "booked"; }
      waitlist.push({ trainId, passenger }); return "waitlisted";
    }

    function cancel(trainId, passenger) {
      const t = trains[trainId];
      if (!t) return "train not found";
      const i = t.booked.indexOf(passenger);
      if (i === -1) return "not found";
      t.booked.splice(i, 1);
      undoStack.push({ type: "cancel", trainId, passenger });
      const idx = waitlist.findIndex(w => w.trainId === trainId);
      if (idx !== -1) { t.booked.push(waitlist[idx].passenger); waitlist.splice(idx, 1); }
      return "canceled";
    }

    function undoLast() {
      const last = undoStack.pop();
      if (!last) return "nothing to undo";
      const t = trains[last.trainId];
      if (t.booked.length < t.seats) t.booked.push(last.passenger);
      else waitlist.unshift({ trainId: last.trainId, passenger: last.passenger });
      return "undo ok";
    }

    function setMsg(text) { document.getElementById('msg').textContent = text; }

    function onBook() {
      const id = document.getElementById('trainId').value.trim();
      const p = document.getElementById('passenger').value.trim();
      if (!id || !p) return setMsg("enter train and passenger");
      setMsg(book(id, p)); render();
    }

    function onCancel() {
      const id = document.getElementById('trainId').value.trim();
      const p = document.getElementById('passenger').value.trim();
      if (!id || !p) return setMsg("enter train and passenger");
      setMsg(cancel(id, p)); render();
    }

    function onUndo() { setMsg(undoLast()); render(); }

    render();
  </script>
</body>
</html>
